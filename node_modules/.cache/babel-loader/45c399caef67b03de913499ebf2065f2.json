{"ast":null,"code":"/**\n * stack-trace - Parses node.js stack traces\n *\n * This was originally forked to fix this issue:\n * https://github.com/felixge/node-stack-trace/issues/31\n *\n * Mar 19,2019 - #4fd379e\n *\n * https://github.com/felixge/node-stack-trace/\n * @license MIT\n */\n\n/** Extracts StackFrames from the Error */\nexport function parse(err) {\n  if (!err.stack) {\n    return [];\n  }\n\n  var lines = err.stack.split('\\n').slice(1);\n  return lines.map(function (line) {\n    if (line.match(/^\\s*[-]{4,}$/)) {\n      return {\n        columnNumber: null,\n        fileName: line,\n        functionName: null,\n        lineNumber: null,\n        methodName: null,\n        native: null,\n        typeName: null\n      };\n    }\n\n    var lineMatch = line.match(/at (?:(.+?)\\s+\\()?(?:(.+?):(\\d+)(?::(\\d+))?|([^)]+))\\)?/);\n\n    if (!lineMatch) {\n      return undefined;\n    }\n\n    var object = null;\n    var method = null;\n    var functionName = null;\n    var typeName = null;\n    var methodName = null;\n    var isNative = lineMatch[5] === 'native';\n\n    if (lineMatch[1]) {\n      functionName = lineMatch[1];\n      var methodStart = functionName.lastIndexOf('.');\n\n      if (functionName[methodStart - 1] === '.') {\n        // eslint-disable-next-line no-plusplus\n        methodStart--;\n      }\n\n      if (methodStart > 0) {\n        object = functionName.substr(0, methodStart);\n        method = functionName.substr(methodStart + 1);\n        var objectEnd = object.indexOf('.Module');\n\n        if (objectEnd > 0) {\n          functionName = functionName.substr(objectEnd + 1);\n          object = object.substr(0, objectEnd);\n        }\n      }\n\n      typeName = null;\n    }\n\n    if (method) {\n      typeName = object;\n      methodName = method;\n    }\n\n    if (method === '<anonymous>') {\n      methodName = null;\n      functionName = null;\n    }\n\n    var properties = {\n      columnNumber: parseInt(lineMatch[4], 10) || null,\n      fileName: lineMatch[2] || null,\n      functionName: functionName,\n      lineNumber: parseInt(lineMatch[3], 10) || null,\n      methodName: methodName,\n      native: isNative,\n      typeName: typeName\n    };\n    return properties;\n  }).filter(function (callSite) {\n    return !!callSite;\n  });\n}","map":{"version":3,"sources":["../src/stacktrace.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * stack-trace - Parses node.js stack traces\n *\n * This was originally forked to fix this issue:\n * https://github.com/felixge/node-stack-trace/issues/31\n *\n * Mar 19,2019 - #4fd379e\n *\n * https://github.com/felixge/node-stack-trace/\n * @license MIT\n */\n\n/** Decoded StackFrame */\nexport interface StackFrame {\n  fileName: string;\n  lineNumber: number;\n  functionName: string;\n  typeName: string;\n  methodName: string;\n  native: boolean;\n  columnNumber: number;\n}\n\n/** Extracts StackFrames from the Error */\nexport function parse(err: Error): StackFrame[] {\n  if (!err.stack) {\n    return [];\n  }\n\n  const lines = err.stack.split('\\n').slice(1);\n\n  return lines\n    .map(line => {\n      if (line.match(/^\\s*[-]{4,}$/)) {\n        return {\n          columnNumber: null,\n          fileName: line,\n          functionName: null,\n          lineNumber: null,\n          methodName: null,\n          native: null,\n          typeName: null,\n        };\n      }\n\n      const lineMatch = line.match(/at (?:(.+?)\\s+\\()?(?:(.+?):(\\d+)(?::(\\d+))?|([^)]+))\\)?/);\n      if (!lineMatch) {\n        return undefined;\n      }\n\n      let object = null;\n      let method = null;\n      let functionName = null;\n      let typeName = null;\n      let methodName = null;\n      const isNative = lineMatch[5] === 'native';\n\n      if (lineMatch[1]) {\n        functionName = lineMatch[1];\n        let methodStart = functionName.lastIndexOf('.');\n        if (functionName[methodStart - 1] === '.') {\n          // eslint-disable-next-line no-plusplus\n          methodStart--;\n        }\n        if (methodStart > 0) {\n          object = functionName.substr(0, methodStart);\n          method = functionName.substr(methodStart + 1);\n          const objectEnd = object.indexOf('.Module');\n          if (objectEnd > 0) {\n            functionName = functionName.substr(objectEnd + 1);\n            object = object.substr(0, objectEnd);\n          }\n        }\n        typeName = null;\n      }\n\n      if (method) {\n        typeName = object;\n        methodName = method;\n      }\n\n      if (method === '<anonymous>') {\n        methodName = null;\n        functionName = null;\n      }\n\n      const properties = {\n        columnNumber: parseInt(lineMatch[4], 10) || null,\n        fileName: lineMatch[2] || null,\n        functionName,\n        lineNumber: parseInt(lineMatch[3], 10) || null,\n        methodName,\n        native: isNative,\n        typeName,\n      };\n\n      return properties;\n    })\n    .filter(callSite => !!callSite) as StackFrame[];\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}